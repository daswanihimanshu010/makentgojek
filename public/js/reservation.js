var uri_segment=function(e){if(""==e)return{};for(var t={},a=0;a<e.length;++a){var n=e[a].split("=",2);1==n.length?t[n[0]]="":t[n[0]]=decodeURIComponent(n[1].replace(/\+/g," "))}return t}(window.location.search.substr(1).split("&"));if(1!=uri_segment.visited){var timer,end=new Date(document.getElementById("expired_at").value).getTime(),_second=1e3,_minute=60*_second,_hour=60*_minute,_day=24*_hour;function showRemaining(){var e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()).getTime(),a=end-t;if(a<0)return clearInterval(timer),document.getElementById("countdown_2").innerHTML="Expired!",document.getElementById("countdown_1").innerHTML="Expired!",void(window.location.href=APP_URL+"/reservation/expire/"+$("#reservation_id").val());Math.floor(a/_day);var n=Math.floor(a%_day/_hour),o=Math.floor(a%_hour/_minute),r=Math.floor(a%_minute/_second);0!==$("#countdown_2").length&&(document.getElementById("countdown_2").innerHTML=n+":",document.getElementById("countdown_2").innerHTML+=o+":",document.getElementById("countdown_2").innerHTML+=r+"",document.getElementById("countdown_1").innerHTML=n+":",document.getElementById("countdown_1").innerHTML+=o+":",document.getElementById("countdown_1").innerHTML+=r+"")}timer=setInterval(showRemaining,1e3),$(document).ready(function(){$("[id$='-trigger']").click(function(){var e="#"+$(this).attr("id").replace("-trigger","");$("#reserve_id").val(e),$(e).removeClass("hide"),$(e).addClass("show"),$(e).attr("aria-hidden","false")}),$('[data-behavior="modal-close"]').click(function(e){e.preventDefault(),$(".modal").removeClass("show"),$(".modal").attr("aria-hidden","true")}),$("#decline_submit").click(function(){var e=$("#decline_reason"),t=$("#decline_message"),a=$("#decline_reason_other");return""==e.val()&&""==t.val()?($("#errors").removeClass("hide"),$("#decline_message").focus(),!1):"other"==e.val()&&""==a.val()?($("#other_errors").removeClass("hide"),$("#decline_reason_other").focus(),!1):void 0}),$("#decline_message").keyup(function(){""==$("#decline_reason").val()&&""==$("#decline_message").val()||$("#errors").addClass("hide")}),$("#decline_reason_other").keyup(function(){""!=$("#decline_reason_other").val()&&$("#other_errors").addClass("hide")}),$("#decline_reason").change(function(){"other"==$(this).val()?($("#decline_reason_other_div").removeClass("hide"),$("#decline_reason_other_div").addClass("show"),$("#errors").addClass("hide")):($("#decline_reason_other_div").removeClass("show"),$("#decline_reason_other_div").addClass("hide"),$("#errors").addClass("hide")),("other"!=$("#decline_reason").val()&&""!=$("#decline_reason").val()||""!=$("#decline_message").val())&&$("#errors").addClass("hide")})})}app.controller("host_change",["$scope","$http",function(e,t){function a(e,a,n,o){$(".special-offer-date-fields").addClass("loading");var r=$("#reservation_code").val();t.post("../rooms/price_calculation",{checkin:a,checkout:e,guest_count:n,room_id:o,change_reservation:r}).then(function(e){$(".special-offer-date-fields").removeClass("loading"),$("#total_price").val(e.data.subtotal)})}setTimeout(function(){var n=e.room_id,o=e.room_id,r=$("#start_date").val(),i=$("#end_date").val();t.post("../rooms/rooms_calendar_alter",{data:n,checkin:r,checkout:i}).then(function(e){e.data.changed_price;var t=e.data.not_avilable;$("#start_date").datepicker({minDate:0,dateFormat:"dd-mm-yy",setDate:new Date($("#start_date").val()),beforeShowDay:function(e){e=jQuery.datepicker.formatDate("yy-mm-dd",e);return-1!=$.inArray(e,t)?[!1]:[!0]},onSelect:function(e){(t=$("#start_date").datepicker("getDate")).setDate(t.getDate()+1),$("#end_date").datepicker("setDate",t),$("#end_date").datepicker("option","minDate",t),setTimeout(function(){$("#end_date").datepicker("show")},20);var t,n=$(this).val();a(t=$("#end_date").val(),n,$("#pricing_guests").val(),o),e!=new Date&&$(".ui-datepicker-today").removeClass("ui-datepicker-today")}}),jQuery("#end_date").datepicker({minDate:1,dateFormat:"dd-mm-yy",setDate:new Date($("#end_date").val()),beforeShowDay:function(e){e=jQuery.datepicker.formatDate("yy-mm-dd",e);return-1!=$.inArray(e,t)?[!1]:[!0]},onClose:function(){var e=$("#start_date").datepicker("getDate");if((n=$("#end_date").datepicker("getDate"))<=e){var t=$("#end_date").datepicker("option","minDate");$("#end_date").datepicker("setDate",t)}var n=$(this).val(),r=(e=$("#start_date").val(),$("#pricing_guests").val());""!=e&&a(n,e,r,o)}})}),$("#pricing_guests").change(function(){var e=$(this).val(),t=$("#start_date").val(),n=$("#end_date").val();""!=t&&""!=n&&($(".js-book-it-status").addClass("loading"),a(n,t,e,o))}),$("#property").change(function(){var e=$(this).val(),t=$("#pricing_guests").val(),n=$("#start_date").val(),o=$("#end_date").val();""!=n&&""!=o&&($(".js-book-it-status").addClass("loading"),a(o,n,t,e))})},10),$("#alter-submit-button").click(function(){$("#chage_confirm").attr("aria-hidden","false")}),$("#cancellation-policy-link").click(function(){$("#cancellation_policy").show()}),$("#no_alteration").click(function(){$("#chage_confirm").attr("aria-hidden","true")}),$("#alteration-submit").click(function(){$("#details-form").submit()})}]);